.card#labs
  .card-header.table-filters{ data: { url: labs_path } }
    = text_field_tag 'searchLabs', params[:term], class: 'form-control form-control-lg table-search', placeholder: t(:labs)[:filters][:search]
    = select_tag 'sort_by', lab_sort_filter_options(params[:sort_by]), class: 'selectpicker filter-select', title: t(:labs)[:filters][:sort_by], include_blank: true, data: { field: 'sort_by', style: 'btn-lg btn-link filter', dropdown_align_right: 'true' }
    = select_tag 'sort_order', options_for_select(t(:constants)[:order].invert, params[:sort_order]), class: 'selectpicker filter-select', data: { field: 'sort_order', style: 'btn-lg btn-link filter', dropdown_align_right: 'true' }
  .card-body.p-0
    .table-overflow
      %table.table.table-bordered.mb-0#labsTable
        %thead
          %tr
            %th.col-2<
              = t(:labs)[:fields][:mrn]
            %th.col-2<
              = t(:labs)[:fields][:accession_numbers]
            %th.col-2<
              = t(:labs)[:fields][:samples_available]
            %th.col-2<
              = t(:labs)[:fields][:specimen_source]
            %th.col-3<
              = t(:labs)[:fields][:protocols]
            %th.col-1<
              = t(:labs)[:fields][:release]
        %tbody
          - if lab_groups.any?
            - lab_groups.each do |grouping, labs|
              %tr
                %td<
                  = grouping[:patient].mrn
                %td<
                  = accession_numbers(labs)
                %td<
                  = labs.count
                %td<
                  = grouping[:specimen_source] || t(:constants)[:na]
                %td<
                  = protocols_preview(grouping[:patient], labs.first.specimen_source)
                %td.text-center<
                  %button.btn.btn-primary{ title: t(:labs)[:tooltips][:release], data: { toggle: 'tooltip', url: new_specimen_record_path(patient_id: grouping[:patient].id) } }
                    = icon('fas', 'share')
          - else
            %tr
              %td.text-center{ colspan: 5 }
                = t(:constants)[:no_records]
