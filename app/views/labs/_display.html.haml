- @labs.where.not("status = ? OR status = ?", "Discarded", "Retrieved").order(status: :desc).each do |lab|
  .card
    .card-header.bg-white
      .row
        .col-5.h3.font-weight-bold
          = "Accession Number: #{lab.accession_number}"
        .col-5.h5{style: "margin-top: 6px;"}
          = "MRN: #{lab.patient.mrn}  |  DOB: #{lab.patient.dob}"
        .col-2.h4
          - if lab.status == "Available"
            .badge.badge-primary
              = "#{lab.status}"
          - elsif lab.status == "Released"
            .badge.badge-success
              = "#{lab.status}"   
    %h5.card-body
      = "#{lab.specimen_source}"
      - if lab.status == "Available"
        - lab.populations.each do |population|
          .row
            %p.mx-4
              - if lab.specimen_source == population.line_item.service_source
                .col-8
                  = "#{population.line_item.sparc_request.protocol.title}"
                .col-3
                  = link_to "", lab_path(lab, type: "release"), method: :patch, class: "btn btn-success fas fa-external-link-alt", title: "Release Specimen", data: {toggle: "tooltip"}
      - elsif lab.status == "Released"
        - lab.populations.each do |population|
          .row
            %p.mx-4
              - if lab.specimen_source == population.line_item.service_source
                .col-8
                  = "#{population.line_item.sparc_request.protocol.title}"
                .col-3
                  = link_to "", lab_path(lab, type: "retrieve"), method: :patch, class: "btn btn-warning fas fa-dolly", title: "Retrieve Specimen", data: {toggle: "tooltip"}
                  = link_to "", lab_path(lab, type: "discard"), method: :patch, class: "btn btn-danger fas fa-trash-alt", title: "Discard Specimen", data: {toggle: "tooltip"}
